***Android SQLite***

activity_main.xml
////////////////////////

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="20dp"
    android:gravity="top"
    tools:context=".MainActivity">

    <EditText
        android:id="@+id/et_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/bg_round"
        android:gravity="center"
        android:hint="Enter text...."
        android:lines="4" />

    <Button
        android:id="@+id/bt_add"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:text="@string/add"/>

    <ListView
        android:id="@+id/list_view"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"/>

</LinearLayout>




bg_round.xml
////////////////////

<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">

    <solid android:color="@android:color/transparent"/>
    <corners android:radius="10dp"/>
    <stroke android:color="@android:color/holo_blue_bright" android:width="3dp"/>
</shape>



MainActivity.java
////////////////////////////

import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.Toast;

import java.util.ArrayList;

public class MainActivity extends AppCompatActivity {
    EditText etText;
    Button btAdd;
    ListView listView;

    DatabaseHelper databaseHelper;
    ArrayList arrayList;
    ArrayAdapter arrayAdapter;


    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //assign variables
        etText=findViewById(R.id.et_text);
        btAdd=findViewById(R.id.bt_add);
        listView=findViewById(R.id.list_view);

        //init databasehelper to Main activity
        databaseHelper =new DatabaseHelper(MainActivity.this);

        //add Dbase to Arraylist
        arrayList=databaseHelper.getAllText();

        //init array adapter
        arrayAdapter =new ArrayAdapter(MainActivity.this, android.R.layout.simple_list_item_1,arrayList);

        //set array adap to listview
        listView.setAdapter(arrayAdapter);

        btAdd.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                //get text from Edit Text
                String text=etText.getText().toString();

                if(!text.isEmpty()){
                    if(databaseHelper.addText(text)){
                        etText.setText("");  //Clears EditText

                        //display toast
                        Toast.makeText(getApplicationContext(),"Data Inserted ...",Toast.LENGTH_SHORT).show();

                        //clear arraylist
                        arrayList.clear();
                        arrayList.addAll(databaseHelper.getAllText());

                        //refresh listview data
                        arrayAdapter.notifyDataSetChanged();
                        listView.invalidateViews();  //is used to tell the ListView to invalidate all its child item views (redraw them).
                        listView.refreshDrawableState();

                    }
                }
            }
        });
    }
}



DatabaseHelper.java
////////////////////

package com.example.datastorage;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

import java.util.ArrayList;

class DatabaseHelper extends SQLiteOpenHelper {
    private static final String DB_NAME="database_name";
    private static final String TB_NAME="table_name";

    DatabaseHelper(Context context)
    {
        super(context,DB_NAME,null,1);
    }


    @Override
    public void onCreate(SQLiteDatabase db) {

        //Creating Table
        String createTable= "create table "+ TB_NAME + "(id INTEGER PRIMARY KEY, txt TEXT)" ;
        db.execSQL(createTable);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        //delete (drop) older table if exists
        db.execSQL("DROP TABLE IF EXISTS "+ TB_NAME);
        onCreate(db);
    }

    public boolean addText(String text){
        //writable db
        SQLiteDatabase sqLiteDatabase=this.getWritableDatabase();

        //get values
        ContentValues contentValues=new ContentValues();
        contentValues.put("txt",text);

        //add val to db
        sqLiteDatabase.insert(TB_NAME,null,contentValues);
        return true;
    }

    public ArrayList getAllText(){

        //readable db
        SQLiteDatabase sqLiteDatabase=this.getReadableDatabase();

        ArrayList<String> arrayList=new ArrayList<String>();

        /*Cursors are what contain the result set of a query made against a database in Android.
        The Cursor class has an API that allows an app to read the columns that were returned from
        the query as well as iterate over the rows of the result set*/

        //Create Cursor
        Cursor cursor=sqLiteDatabase.rawQuery("select * from " +TB_NAME,null);

        cursor.moveToFirst();
        /*moveToFirst() does two things:
        it allows you to test whether the query returned an empty set (by testing the return value)
        and it moves the cursor to the first result (when the set is not empty)*/

        while (!cursor.isAfterLast()){
            arrayList.add(cursor.getString(cursor.getColumnIndex("txt")));
            cursor.moveToNext();
        }

        return arrayList;
    }
}

